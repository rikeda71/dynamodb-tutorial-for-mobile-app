# Memo

## テーブル作成時の注意点

- 異なるエンティティを 1 つのテーブルに保存しているので、プライマリーキーは、UserId のような名前の属性を使用することはできません。この属性は、保存するエンティティのタイプに基づいて異なる何かを意味します。たとえば、ユーザーのプライマリキーは USERNAME であり、ゲームのプライマリキーはその TYPE であるかもしれません。したがって、PK (パーティションキー用) や SK (ソートキー用) などの一般的な名前を属性に使用します。
  - [link](https://aws.amazon.com/jp/getting-started/hands-on/design-a-database-for-a-mobile-app-with-dynamodb/4/) より

## ソートキーの設計

- 文字列タイプのソートキーは、ASCII 文字コードでソートされます。ASCII のドル記号 ($) はポンド記号 (#) の直後にあるため、 Photo エンティティですべてのマッピングを確実に取得できます。
  - [link](https://aws.amazon.com/jp/getting-started/hands-on/design-a-database-for-a-mobile-app-with-dynamodb/4/) より

## 転置インデックス

- 転置インデックスは、DynamoDB での一般的なセカンダリインデックスのデザインパターンです。転置インデックスを使用して、テーブルのプライマリキーの逆であるセカンダリインデックスを作成します。テーブルの HASH キーがインデックスの RANGE キーになり、テーブルの RANGE キーがインデックスのプライマリキーになります。
  - 検索エンジンの文脈だと、単語をキーとした連想配列
- 転置インデックスは、2 つのシナリオで役立ちます。
  - 多対多関係の「反対側」をクエリするのに役立ちます
    - Secondary Index をクエリに適応することで、PKの一覧を検索できる
  - それ自体が一対多関係の対象であるエンティティの一対多関係をクエリする場合にも役立ちます
    - Secondary Index 間での関連を結びつけることができる
- __転置インデックスは DynamoDB の公式プロパティではなく、デザインパターンの名前であることに注意__
